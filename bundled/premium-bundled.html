<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Premium - StoryBot</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
/* Main CSS file - extracted from styles.css */
/* Global styles and variables */
:root {
  --primary-color: #5865F2;
  --success-color: #43b581;
  --warning-color: #e9b84e;
  --danger-color: #f04747;
  --dark-bg: #23272a;
  --darker-bg: #2c2f33;
  --light-bg: #f8f9fa;
  --text-light: rgba(255, 255, 255, 0.8);
  --text-muted: #6c757d;
  --shadow-sm: 0 5px 15px rgba(0, 0, 0, 0.1);
  --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.15);
  --transition-default: all 0.3s ease;
}

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  margin: 0;
  padding: 0;
}

/* Common layout elements */
.page-header {
  background-color: var(--dark-bg);
  color: white;
  padding: 120px 0 60px;
  text-align: center;
}

footer {
  background-color: var(--dark-bg);
  color: white;
  padding: 2rem 0;
}

footer a {
  color: var(--primary-color);
  text-decoration: none;
}

footer a:hover {
  color: #7289da;
  text-decoration: underline;
}

/* Buttons */
.btn-primary {
  background-color: var(--primary-color);
  border-color: var(--primary-color);
}

.btn-primary:hover {
  background-color: #4752c4;
  border-color: #4752c4;
}

.btn-success {
  background-color: var(--success-color);
  border-color: var(--success-color);
}

.premium-btn {
  background-color: var(--warning-color);
  border-color: var(--warning-color);
  color: var(--dark-bg);
  font-weight: bold;
}

.premium-btn:hover {
  background-color: #d9a83e;
  border-color: #d9a83e;
  color: var(--dark-bg);
}

/* Feature cards (used across multiple pages) */
.feature-card {
  background-color: white;
  border-radius: 10px;
  padding: 30px;
  height: 100%;
  box-shadow: var(--shadow-sm);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.feature-card:hover {
  transform: translateY(-5px);
  box-shadow: var(--shadow-lg);
}

.feature-card h3 {
  margin-bottom: 15px;
  font-weight: 600;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .page-header {
    padding: 100px 0 40px;
  }
  
  .feature-card, .testimonial-card {
    margin-bottom: 20px;
  }
}

/* Override Bootstrap background utilities */
.bg-dark {
  background-color: var(--dark-bg) !important;
}

.bg-darker {
  background-color: var(--darker-bg) !important;
}

.bg-light {
  background-color: var(--light-bg) !important;
}

.bg-primary {
  background-color: var(--primary-color) !important;
}

.bg-success {
  background-color: var(--success-color) !important;
}

.bg-warning {
  background-color: var(--warning-color) !important;
}


</style>
  <style>
/* Navbar specific styles */
.navbar {
  padding: 0.5rem 0;
  background-color: rgba(35, 39, 42, 0.95);
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
  position: fixed;
  top: 0;
  width: 100%;
  z-index: 1000;
}

.navbar-brand {
  font-weight: 700;
  font-size: 1.5rem;
  color: white;
}

.navbar-dark .navbar-nav .nav-link {
  color: rgba(255, 255, 255, 0.8);
  font-weight: 500;
  padding: 0.5rem 1rem;
  transition: color 0.3s ease;
}

.navbar-dark .navbar-nav .nav-link:hover,
.navbar-dark .navbar-nav .nav-link.active {
  color: white;
}

.navbar-dark .navbar-toggler {
  border-color: rgba(255, 255, 255, 0.1);
}

.navbar-dark .navbar-toggler-icon {
  background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 255, 255, 0.8%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
}

/* Brand container styles */
.brand-container {
  display: flex;
  align-items: center;
  gap: 10px;
}

.brand-icon {
  width: 48px;
  height: 48px;
  background: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
}

.brand-img {
  width: 40px;
  height: 40px;
  object-fit: contain;
}

/* Fix for navbar on mobile */
@media (max-width: 991.98px) {
  .navbar-collapse {
    background-color: rgba(35, 39, 42, 0.95);
    padding: 1rem;
    border-radius: 0.5rem;
    margin-top: 0.5rem;
  }
  
  .navbar-nav {
    padding: 0.5rem 0;
  }
  
  .nav-item {
    margin-bottom: 0.5rem;
  }
  
  .navbar-nav .btn {
    display: block;
    width: 100%;
    text-align: left;
    margin-top: 0.5rem;
  }
}

</style>
  <style>
/* Premium page specific styles */

.feature-card {
  background-color: white;
  border-radius: 10px;
  padding: 30px;
  height: 100%;
  box-shadow: var(--shadow-sm);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.feature-card:hover {
  transform: translateY(-5px);
  box-shadow: var(--shadow-lg);
}

.feature-card h3 {
  margin-bottom: 15px;
  font-weight: 600;
}

/* Comparison table styles - Light Theme */
.comparison-table {
  background-color: var(--light-bg);
  border-radius: 10px;
  overflow: hidden;
  margin-bottom: 40px;
  box-shadow: var(--shadow-sm);
  border: 1px solid #e0e0e0;
}

.comparison-header {
  background-color: #f0f0f0;
  color: var(--dark-bg);
  padding: 20px;
  text-align: center;
  font-weight: bold;
  font-size: 1.2rem;
  border-bottom: 1px solid #e0e0e0;
}

.comparison-header.premium {
  color: var(--warning-color);
  background-color: #f8f5e6;
}

.comparison-row {
  display: flex;
  border-bottom: 1px solid #e0e0e0;
}

.comparison-row:last-child {
  border-bottom: none;
}

.comparison-category {
  background-color: #f0f0f0;
  color: var(--dark-bg);
  padding: 15px 20px;
  width: 100%;
  font-weight: bold;
}

.comparison-feature {
  background-color: var(--light-bg);
  color: #555;
  padding: 15px 20px;
  width: 100%;
}

.comparison-value {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 15px;
  width: 100%;
  color: #333;
  text-align: center;
  background-color: white;
}

.check-icon {
  color: var(--success-color);
  font-size: 1.2rem;
}

.x-icon {
  color: var(--danger-color);
  font-size: 1.2rem;
}

.infinity-icon {
  color: var(--success-color);
  font-size: 1.2rem;
}

/* Add subtle hover effect to rows */
.comparison-row:hover .comparison-feature,
.comparison-row:hover .comparison-value {
  background-color: #f9f9f9;
}

/* Add subtle border between columns */
.comparison-value {
  border-left: 1px solid #e0e0e0;
}

/* Testimonials */
.testimonial-card {
  background-color: white;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: var(--shadow-sm);
  height: 100%;
}

.testimonial-content {
  padding: 25px;
  font-style: italic;
  position: relative;
}

.testimonial-content:before {
  content: '"';
  font-size: 60px;
  color: #f0f0f0;
  position: absolute;
  top: 10px;
  left: 10px;
  font-family: Georgia, serif;
  z-index: 0;
}

.testimonial-content p {
  position: relative;
  z-index: 1;
}

.testimonial-author {
  display: flex;
  align-items: center;
  padding: 15px 25px;
  background-color: var(--light-bg);
  border-top: 1px solid #eee;
}

.testimonial-author img {
  width: 50px;
  height: 50px;
  margin-right: 15px;
}

.testimonial-author h5 {
  margin-bottom: 0;
  font-weight: 600;
}

.testimonial-author p {
  margin-bottom: 0;
  color: var(--text-muted);
  font-size: 0.9rem;
}

/* FAQ section */
.faq {
  background-color: var(--light-bg);
}

.accordion-item {
  background-color: white;
  border: 1px solid #e0e0e0;
  margin-bottom: 10px;
  border-radius: 8px;
  overflow: hidden;
}

.accordion-button {
  background-color: white;
  font-weight: 600;
  padding: 15px 20px;
}

.accordion-button:not(.collapsed) {
  background-color: var(--light-bg);
  color: var(--primary-color);
  box-shadow: none;
}

.accordion-button:focus {
  box-shadow: none;
  border-color: #e0e0e0;
}

.accordion-body {
  padding: 20px;
  color: var(--text-muted);
}

</style>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
    <div class="container">
      <a class="navbar-brand" href="index.html">
        <div class="brand-container">
          <div class="brand-icon">
            <img src="https://raw.githubusercontent.com/NathanHinthorne/StoryBot-website/refs/heads/main/images/logo-large.png" alt="StoryBot Logo" class="brand-img">
          </div>
          <span>StoryBot</span>
        </div>
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="https://sites.google.com/view/discord-storybot/home">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://sites.google.com/view/discord-storybot/about">About</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="https://sites.google.com/view/discord-storybot/premium">Premium</a>
          </li>
        </ul>                                                                                                
      </div>
    </div>
  </nav>

  <div class="page-header">
    <div class="container">
      <h1>Premium Features</h1>
      <p class="lead">Unlock the full potential of StoryBot with our Premium tier</p>
    </div>
  </div>

  <section class="premium-section bg-white py-5">
    <div class="container">
      <div class="row mb-5">
        <div class="col-lg-8 mx-auto text-center">
          <h2>Choose the Right Plan for Your Community</h2>
          <p class="lead">StoryBot offers both free and premium options to fit your storytelling needs</p>
        </div>
      </div>

      <div class="row">
        <div class="col-lg-10 mx-auto">
          <div class="comparison-table">
            <div class="row g-0">
              <div class="col-4">
                <div class="comparison-header">Comparison</div>
              </div>
              <div class="col-4">
                <div class="comparison-header">Free</div>
              </div>
              <div class="col-4">
                <div class="comparison-header premium">Premium</div>
              </div>
            </div>

            <!-- Story Contributions -->
            <div class="row g-0">
              <div class="col-12">
                <div class="comparison-category">Story Limits</div>
              </div>
            </div>
            <div class="row g-0">
              <div class="col-4">
                <div class="comparison-feature">Max story length</div>
              </div>
              <div class="col-4">
                <div class="comparison-value">75 contributions</div>
              </div>
              <div class="col-4">
                <div class="comparison-value"><i class="fas fa-infinity infinity-icon"></i></div>
              </div>
            </div>
            <div class="row g-0">
              <div class="col-4">
                <div class="comparison-feature">Max stored stories</div>
              </div>
              <div class="col-4">
                <div class="comparison-value">3</div>
              </div>
              <div class="col-4">
                <div class="comparison-value"><i class="fas fa-infinity infinity-icon"></i></div>
              </div>
            </div>
            <div class="row g-0">
              <div class="col-4">
                <div class="comparison-feature">Time before story expiration</div>
              </div>
              <div class="col-4">
                <div class="comparison-value">30 days</div>
              </div>
              <div class="col-4">
                <div class="comparison-value"><i class="fas fa-infinity infinity-icon"></i></div>
              </div>
            </div>

            <!-- AI Features -->
            <div class="row g-0">
              <div class="col-12">
                <div class="comparison-category">AI Features</div>
              </div>
            </div>
            <div class="row g-0">
              <div class="col-4">
                <div class="comparison-feature">Plot twist daily limit</div>
              </div>
              <div class="col-4">
                <div class="comparison-value">1 per day</div>
              </div>
              <div class="col-4">
                <div class="comparison-value"><i class="fas fa-infinity infinity-icon"></i></div>
              </div>
            </div>
            <div class="row g-0">
              <div class="col-4">
                <div class="comparison-feature">Recap daily limit</div>
              </div>
              <div class="col-4">
                <div class="comparison-value">1 per day</div>
              </div>
              <div class="col-4">
                <div class="comparison-value"><i class="fas fa-infinity infinity-icon"></i></div>
              </div>
            </div>

            <!-- Core Features -->
            <div class="row g-0">
              <div class="col-12">
                <div class="comparison-category">Core Features</div>
              </div>
            </div>
            <div class="row g-0">
              <div class="col-4">
                <div class="comparison-feature">Collaborative storytelling</div>
              </div>
              <div class="col-4">
                <div class="comparison-value"><i class="fas fa-check check-icon"></i></div>
              </div>
              <div class="col-4">
                <div class="comparison-value"><i class="fas fa-check check-icon"></i></div>
              </div>
            </div>
            <div class="row g-0">
              <div class="col-4">
                <div class="comparison-feature">Basic AI assistance</div>
              </div>
              <div class="col-4">
                <div class="comparison-value"><i class="fas fa-check check-icon"></i></div>
              </div>
              <div class="col-4">
                <div class="comparison-value"><i class="fas fa-check check-icon"></i></div>
              </div>
            </div>
            <div class="row g-0">
              <div class="col-4">
                <div class="comparison-feature">Story export to Google Docs</div>
              </div>
              <div class="col-4">
                <div class="comparison-value"><i class="fas fa-times x-icon"></i></div>
              </div>
              <div class="col-4">
                <div class="comparison-value"><i class="fas fa-check check-icon"></i></div>
              </div>
            </div>
            <div class="row g-0">
              <div class="col-4">
                <div class="comparison-feature">Priority support</div>
              </div>
              <div class="col-4">
                <div class="comparison-value"><i class="fas fa-times x-icon"></i></div>
              </div>
              <div class="col-4">
                <div class="comparison-value"><i class="fas fa-check check-icon"></i></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row mt-4">
        <div class="col-lg-8 mx-auto text-center">
          <div id="purchase-container" style="display: none;">
            <button id="purchase-btn" class="btn btn-success btn-lg premium-btn">
              <i class="fas fa-bolt me-2"></i>Upgrade to Premium for $9.99
            </button>
            <p class="mt-2 text-muted">One-time payment, lifetime access</p>
          </div>
          <div id="not-logged-container">
            <p class="mb-3">Login with Discord to upgrade to Premium</p>
            <button class="btn btn-primary btn-lg" onclick="redirectToDiscordAuth()">
              <i class="fab fa-discord me-2"></i>Login with Discord
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="premium-features py-5 bg-light">
    <div class="container">
      <h2 class="text-center mb-5">Premium Benefits in Detail</h2>
      
      <div class="row">
        <div class="col-md-6 mb-4">
          <div class="feature-card">
            <h3><i class="fas fa-infinity me-2 text-success"></i>Unlimited Stories</h3>
            <p>Create and store as many stories as you want without worrying about limits or expiration. Your stories will be preserved indefinitely.</p>
          </div>
        </div>
        <div class="col-md-6 mb-4">
          <div class="feature-card">
            <h3><i class="fas fa-bolt me-2 text-warning"></i>Unlimited AI Features</h3>
            <p>Use plot twists, recaps, and other AI-powered features as often as you want without daily restrictions.</p>
          </div>
        </div>
        <div class="col-md-6 mb-4">
          <div class="feature-card">
            <h3><i class="fas fa-file-export me-2 text-primary"></i>Google Docs Export</h3>
            <p>Export your completed stories directly to Google Docs for easy sharing, editing, and preservation.</p>
          </div>
        </div>
        <div class="col-md-6 mb-4">
          <div class="feature-card">
            <h3><i class="fas fa-headset me-2 text-danger"></i>Priority Support</h3>
            <p>Get faster responses and dedicated assistance for any issues or questions you might have.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="testimonials py-5">
    <div class="container">
      <h2 class="text-center mb-5">What Our Premium Users Say</h2>
      
      <div class="row">
        <div class="col-md-4 mb-4">
          <div class="testimonial-card">
            <div class="testimonial-content">
              <p>"StoryBot Premium transformed our server's game nights. The unlimited contributions mean our stories can be as epic as we want them to be!"</p>
            </div>
            <div class="testimonial-author">
              <img src="https://via.placeholder.com/50" alt="User" class="rounded-circle">
              <div>
                <h5>Alex Johnson</h5>
                <p>Server Owner</p>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-4 mb-4">
          <div class="testimonial-card">
            <div class="testimonial-content">
              <p>"The unlimited plot twists feature is amazing! Our stories are so much more dynamic and surprising now that we can use them whenever inspiration strikes."</p>
            </div>
            <div class="testimonial-author">
              <img src="https://via.placeholder.com/50" alt="User" class="rounded-circle">
              <div>
                <h5>Sarah Miller</h5>
                <p>Community Manager</p>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-4 mb-4">
          <div class="testimonial-card">
            <div class="testimonial-content">
              <p>"Being able to export our stories to Google Docs has been a game-changer. We've even published some of our best collaborative works online!"</p>
            </div>
            <div class="testimonial-author">
              <img src="https://via.placeholder.com/50" alt="User" class="rounded-circle">
              <div>
                <h5>Michael Chen</h5>
                <p>Writing Group Leader</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="faq py-5 bg-light">
    <div class="container">
      <h2 class="text-center mb-5">Frequently Asked Questions</h2>
      
      <div class="row">
        <div class="col-lg-8 mx-auto">
          <div class="accordion" id="faqAccordion">
            <div class="accordion-item">
              <h2 class="accordion-header" id="headingOne">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                  How does the premium payment work?
                </button>
              </h2>
              <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#faqAccordion">
                <div class="accordion-body">
                  Premium is a one-time payment of $9.99 that gives your selected Discord server lifetime access to all premium features.
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header" id="headingTwo">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                  Can I transfer my premium status to another account?
                </button>
              </h2>
              <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#faqAccordion">
                <div class="accordion-body">
                  Premium status is tied to the server you select during the upgrade process. Only the server you upgrade on will benefit from your purchase.
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header" id="headingThree">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                  What happens to my stories if I don't upgrade?
                </button>
              </h2>
              <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#faqAccordion">
                <div class="accordion-body">
                  With the free tier, you can store up to 3 stories, and they will be automatically purged after 30 days. Stories are also limited to 75 contributions before they're automatically ended.
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header" id="headingFour">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                  Do all members in my server need premium?
                </button>
              </h2>
              <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour" data-bs-parent="#faqAccordion">
                <div class="accordion-body">
                  No, only one person with management permissions needs to have premium for the entire server to benefit from premium features. All members can enjoy unlimited storytelling!
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <footer class="bg-dark text-white py-4">
    <div class="container">
      <div class="row">
        <div class="col-md-6">
          <h5>StoryBot</h5>
          <p>Collaborative storytelling for Discord communities</p>
        </div>
        <div class="col-md-6 text-md-end">
          <p class="mb-0">Â© 2025 StoryBot. All rights reserved.</p>
        </div>
      </div>
    </div>
  </footer>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
  
  <!-- External libraries -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://js.stripe.com/v3/"></script>
  
  <!-- Application scripts -->
  <script>
// Firebase configuration
const FIREBASE_CONFIG = {
  apiKey: "your-api-key",
  authDomain: "your-project-id.firebaseapp.com",
  projectId: "your-project-id",
  storageBucket: "your-project-id.appspot.com",
  messagingSenderId: "your-messaging-sender-id",
  appId: "your-app-id"
};

// Initialize Firebase
firebase.initializeApp(FIREBASE_CONFIG);
const db = firebase.firestore();

// User-related Firebase functions
async function getUserData(userId) {
  try {
    const doc = await db.collection('users').doc(userId).get();
    if (doc.exists) {
      return doc.data();
    }
    return null;
  } catch (error) {
    console.error("Error fetching user data:", error);
    return null;
  }
}

async function isUserPremium(userId) {
  const userData = await getUserData(userId);
  return userData && userData.isPremium;
}
</script>
  <script>
// Authentication related functionality
const AUTH_CONFIG = {
  CLIENT_ID: 'your_discord_client_id',
  REDIRECT_URI: `${window.location.origin}/auth/callback`,
  SCOPES: 'identify guilds'
};

// Discord OAuth2 login
function redirectToDiscordAuth() {
  const redirectUri = encodeURIComponent(AUTH_CONFIG.REDIRECT_URI);
  const scopes = encodeURIComponent(AUTH_CONFIG.SCOPES);
  
  window.location.href = `https://discord.com/api/oauth2/authorize?client_id=${AUTH_CONFIG.CLIENT_ID}&redirect_uri=${redirectUri}&response_type=code&scope=${scopes}`;
}

// Check URL for auth callback
function checkAuthCallback() {
  const urlParams = new URLSearchParams(window.location.search);
  const authCode = urlParams.get('code');

  if (authCode) {
    // Exchange code for token
    exchangeCodeForToken(authCode);
    return true;
  }
  return false;
}

async function exchangeCodeForToken(code) {
  try {
    const response = await fetch('/auth/discord', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ code }),
    });
    
    const data = await response.json();
    
    if (data.userId) {
      localStorage.setItem('discordUserId', data.userId);
      window.location.href = '/'; // Redirect to home page
    }
  } catch (error) {
    console.error('Auth error:', error);
  }
}

// Check if user is logged in
function isUserLoggedIn() {
  return !!localStorage.getItem('discordUserId');
}

// Get current user ID
function getCurrentUserId() {
  return localStorage.getItem('discordUserId');
}

// Logout function
function logout() {
  localStorage.removeItem('discordUserId');
  window.location.reload();
}
</script>
  <script>
// Premium page specific functionality
const STRIPE_CONFIG = {
  publishableKey: 'your_stripe_publishable_key'
};

// Setup UI based on user status
async function setupPremiumUI() {
  const userId = getCurrentUserId();
  
  if (userId) {
    document.getElementById('not-logged-container').style.display = 'none';
    document.getElementById('purchase-container').style.display = 'block';
    
    // Check if user is already premium
    const isPremium = await isUserPremium(userId);
    if (isPremium) {
      // User is already premium, show different UI
      document.getElementById('purchase-btn').textContent = 'Premium Active';
      document.getElementById('purchase-btn').classList.add('btn-secondary');
      document.getElementById('purchase-btn').disabled = true;
    } else {
      // Setup Stripe purchase button
      setupPurchaseButton(userId);
    }
  }
}

// Setup Stripe purchase button
function setupPurchaseButton(userId) {
  document.getElementById('purchase-btn').addEventListener('click', async () => {
    try {
      const response = await fetch('/create-checkout-session', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          discordUserId: userId
        }),
      });
      
      const session = await response.json();
      
      // Redirect to Stripe Checkout
      const stripe = Stripe(STRIPE_CONFIG.publishableKey);
      stripe.redirectToCheckout({ sessionId: session.id });
    } catch (error) {
      console.error('Error:', error);
    }
  });
}
</script>
  <script>
// Main application entry point
document.addEventListener('DOMContentLoaded', function() {
  // Check for auth callback first
  if (checkAuthCallback()) {
    return; // Auth callback is being handled, stop further execution
  }
  
  // Initialize UI based on current page
  const currentPage = getCurrentPage();
  
  // Common UI setup for all pages
  setupNavbar();
  
  // Page-specific initialization
  switch (currentPage) {
    case 'index':
      setupHomePage();
      break;
    case 'premium':
      setupPremiumPage();
      break;
    case 'about':
      setupAboutPage();
      break;
  }
});

// Determine current page
function getCurrentPage() {
  const path = window.location.pathname;
  if (path.includes('premium.html')) return 'premium';
  if (path.includes('about.html')) return 'about';
  return 'index'; // Default to home page
}

// Setup navbar based on login status
function setupNavbar() {
  const userLoggedIn = isUserLoggedIn();
  
  // Show/hide login button in navbar
  const loginBtn = document.getElementById('login-btn');
  if (loginBtn) {
    loginBtn.style.display = userLoggedIn ? 'none' : 'block';
  }
  
  // Add logout button if user is logged in
  if (userLoggedIn && !document.getElementById('logout-btn')) {
    const navbarNav = document.getElementById('navbarNav');
    if (navbarNav) {
      const navList = navbarNav.querySelector('ul');
      const logoutItem = document.createElement('li');
      logoutItem.className = 'nav-item';
      logoutItem.innerHTML = `
        <button id="logout-btn" class="btn btn-outline-light" onclick="logout()">
          <i class="fas fa-sign-out-alt me-2"></i>Logout
        </button>
      `;
      navList.appendChild(logoutItem);
    }
  }
}

// Home page setup
function setupHomePage() {
  const userLoggedIn = isUserLoggedIn();
  
  // Show purchase container if logged in
  const purchaseContainer = document.getElementById('purchase-container');
  const notLoggedContainer = document.getElementById('not-logged-container');
  
  if (purchaseContainer && notLoggedContainer) {
    purchaseContainer.style.display = userLoggedIn ? 'block' : 'none';
    notLoggedContainer.style.display = userLoggedIn ? 'none' : 'block';
  }
}

// Premium page setup
function setupPremiumPage() {
  setupPremiumUI();
}

// About page setup
function setupAboutPage() {
  // Any about page specific initialization
}
</script>
</body>
</html>


